# Working agreement (Stage + GitHub)

## Цель
Быстро итеративно развиваем продукт без ручных действий на сервере и без постоянного SSH.

## Основные правила
- Любое изменение — через PR в `main`.
- Деплой на stage — через GitHub Actions на self-hosted runner (`self-hosted, stage`).
- Быстрые проверки (fast) — всегда.
- Длинные проверки (deep) — не чаще 1 раза в день или ~раз в 20 задач (ручной запуск).

## Baseline / откаты
- Перед крупными изменениями создаём tag/release вида `baseline-YYYY-MM-DD`.
- Откат = checkout нужного tag + повторный `Stage Deploy` (workflow_dispatch).

## Стиль изменений (важно для UX)
- Интеграции (LLM/SMS/ML) меняются редко → делаем через provider/adapters + env.
- UI/документы меняются часто → каноничный формат (JSON/MD) + отдельный рендерер.
- Никаких "жёстких" привязок фронта к одному виду документа.

## Definition of Done (по умолчанию)
- `Stage Status` зелёный
- `Stage Smoke` зелёный
- В логах нет ошибок конфигурации Caddy/роутинга
